<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{base}">
    <head>
        <title th:text="${cliente?.id != null} ? 'Editar Cliente - Sistema CV' : 'Nuevo Cliente - Sistema CV'">
            Formulario Cliente - Sistema CV
        </title>

        <!-- Estilos específicos para formulario de clientes -->
    <th:block layout:fragment="styles">
        <link rel="stylesheet" th:href="@{/css/StyleCF.css}">
    </th:block>
</head>

<body>
    <!-- Contenido principal - Se inserta en el layout base -->
    <div layout:fragment="content">
        <div class="container-fluid">
            <!-- Card Principal -->
            <div class="card card-custom-form">
                <div class="card-header card-header-custom">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">
                            <i class="fas me-2" 
                               th:classappend="${cliente?.id != null} ? 'fa-user-edit' : 'fa-user-plus'"></i>
                            <span th:text="${cliente?.id != null} ? 'Editar Información del Cliente' : 'Registrar Nuevo Cliente'">
                                Formulario de Cliente
                            </span>
                        </h5>
                        <a th:href="@{/clientes}" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left me-2"></i>Volver a Clientes
                        </a>
                    </div>
                </div>

                <div class="card-body">
                    <form th:action="@{/clientes/guardar}" method="post" class="needs-validation" novalidate id="clienteForm">
                        <input type="hidden" name="id" th:value="${cliente?.id}">

                        <!-- Información Básica -->
                        <div class="form-section">
                            <h6 class="section-title">
                                <i class="fas fa-id-card me-2"></i>Información Básica
                            </h6>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="nombre" class="form-label">Nombre <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="nombre" name="nombre" 
                                           th:value="${cliente?.nombre}" required>
                                    <div class="invalid-feedback">
                                        Por favor ingrese el nombre del cliente.
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="apellido" class="form-label">Apellido <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="apellido" name="apellido" 
                                           th:value="${cliente?.apellido}" required>
                                    <div class="invalid-feedback">
                                        Por favor ingrese el apellido del cliente.
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="tipoDocumento" class="form-label">Tipo de Documento<span class="text-danger">*</span></label>
                                    <select class="form-select" id="tipoDocumento" name="tipoDocumento" required>
                                        <option value="">Seleccionar...</option>
                                        <option value="CC" th:selected="${cliente?.tipoDocumento == 'CC'}">Cédula de Ciudadanía</option>
                                        <option value="NIT" th:selected="${cliente?.tipoDocumento == 'NIT'}">NIT</option>
                                        <option value="CE" th:selected="${cliente?.tipoDocumento == 'CE'}">Carnet Extranjería</option>
                                        <option value="PAS" th:selected="${cliente?.tipoDocumento == 'PAS'}">Pasaporte</option>
                                    </select>
                                    <div class="invalid-feedback">
                                        Por favor seleccione el tipo de documento.
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="numeroDocumento" class="form-label">Número de Documento<span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="numeroDocumento" name="numeroDocumento" 
                                           th:value="${cliente?.numeroDocumento}" required>
                                    <div class="invalid-feedback">
                                        Por favor ingrese el número de documento.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Información de Contacto -->
                        <div class="form-section">
                            <h6 class="section-title">
                                <i class="fas fa-address-book me-2"></i>Información de Contacto
                            </h6>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="email" class="form-label">Correo Electrónico<span class="text-danger">*</span></label>
                                    <input type="email" class="form-control" id="email" name="email" 
                                           th:value="${cliente?.email}" required>
                                    <div class="form-text">Ejemplo: cliente@empresa.com</div>
                                    <div class="invalid-feedback">
                                        Por favor ingrese un correo electrónico válido.
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="telefono" class="form-label">Teléfono/Celular<span class="text-danger">*</span></label>
                                    <input type="tel" class="form-control" id="telefono" name="telefono" 
                                           th:value="${cliente?.telefono}" required>
                                    <div class="invalid-feedback">
                                        Por favor ingrese el teléfono/celular.
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-12 mb-3">
                                    <label for="direccion" class="form-label">Dirección<span class="text-danger">*</span></label>
                                    <textarea class="form-control" id="direccion" name="direccion" 
                                              rows="2" required th:text="${cliente?.direccion}"></textarea>
                                    <div class="invalid-feedback">
                                        Por favor ingrese la dirección.
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="ciudad" class="form-label">Ciudad</label>
                                    <input type="text" class="form-control" id="ciudad" name="ciudad" 
                                           th:value="${cliente?.ciudad}">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="pais" class="form-label">País</label>
                                    <input type="text" class="form-control" id="pais" name="pais" 
                                           th:value="${cliente?.pais}" value="Colombia">
                                </div>
                            </div>
                        </div>

                        <!-- Información Comercial -->
                        <div class="form-section">
                            <h6 class="section-title">
                                <i class="fas fa-chart-line me-2"></i>Información Comercial
                            </h6>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="tipo" class="form-label">Tipo de Cliente <span class="text-danger">*</span></label>
                                    <select class="form-select" id="tipo" name="tipo" required>
                                        <option value="">Seleccionar...</option>
                                        <option value="Regular" th:selected="${cliente?.tipo == 'Regular'}">Regular</option>
                                        <option value="Premium" th:selected="${cliente?.tipo == 'Premium'}">Premium</option>
                                    </select>
                                    <div class="invalid-feedback">
                                        Por favor seleccione el tipo de cliente.
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="estado" class="form-label">Estado <span class="text-danger">*</span></label>
                                    <select class="form-select" id="estado" name="estado" required>
                                        <option value="">Seleccionar...</option>
                                        <option value="Activo" th:selected="${cliente?.estado == 'Activo'}">Activo</option>
                                        <option value="Inactivo" th:selected="${cliente?.estado == 'Inactivo'}">Inactivo</option>
                                        <option value="Suspendido" th:selected="${cliente?.estado == 'Suspendido'}">Suspendido</option>
                                    </select>
                                    <div class="invalid-feedback">
                                        Por favor seleccione el estado del cliente.
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="limiteCredito" class="form-label">Límite de Crédito</label>
                                    <div class="input-group">
                                        <span class="input-group-text">$</span>
                                        <input type="number" class="form-control" id="limiteCredito" name="limiteCredito" 
                                               th:value="${cliente?.limiteCredito}" step="0.01" min="0">
                                    </div>
                                    <div class="form-text">Monto máximo de crédito autorizado</div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="descuento" class="form-label">Descuento (%)</label>
                                    <div class="input-group">
                                        <input type="number" class="form-control" id="descuento" name="descuento" 
                                               th:value="${cliente?.descuento}" step="0.1" min="0" max="100">
                                        <span class="input-group-text">%</span>
                                    </div>
                                    <div class="form-text">Porcentaje de descuento aplicable</div>
                                </div>
                            </div>
                        </div>

                        <!-- Información Adicional -->
                        <div class="form-section">
                            <h6 class="section-title">
                                <i class="fas fa-sticky-note me-2"></i>Información Adicional
                            </h6>
                            <div class="row">
                                <div class="col-12 mb-3">
                                    <label for="observaciones" class="form-label">Observaciones</label>
                                    <textarea class="form-control" id="observaciones" name="observaciones" 
                                              rows="3" placeholder="Notas adicionales sobre el cliente..." 
                                              th:text="${cliente?.observaciones}"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Botones de acción -->
                        <div class="form-actions">
                            <div class="d-flex justify-content-between align-items-center">
                                <a th:href="@{/clientes}" class="btn btn-outline-secondary">
                                    <i class="fas fa-times me-2"></i>Cancelar
                                </a>
                                <div>
                                    <button type="reset" class="btn btn-outline-warning me-2" id="btnLimpiar">
                                        <i class="fas fa-redo me-2"></i>Limpiar
                                    </button>
                                    <button type="submit" class="btn btn-custom" id="btnGuardar">
                                        <i class="fas me-2" th:classappend="${cliente?.id != null} ? 'fa-sync-alt' : 'fa-save'"></i>
                                        <span th:text="${cliente?.id != null} ? 'Actualizar Cliente' : 'Registrar Cliente'">
                                            Guardar Cliente
                                        </span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Información importante -->
            <div class="card card-custom-form mt-4">
                <div class="card-body">
                    <h6 class="mb-3"><i class="fas fa-info-circle me-2 text-primary"></i>Información Importante</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <ul class="list-unstyled">
                                <li class="mb-2">
                                    <small class="text-muted">
                                        <i class="fas fa-asterisk text-danger me-1"></i>
                                        Campos marcados con asterisco (*) son obligatorios
                                    </small>
                                </li>
                                <li class="mb-2">
                                    <small class="text-muted">
                                        <i class="fas fa-user me-1 text-primary"></i>
                                        Los clientes Premium reciben beneficios exclusivos
                                    </small>
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <ul class="list-unstyled">
                                <li class="mb-2">
                                    <small class="text-muted">
                                        <i class="fas fa-credit-card me-1 text-success"></i>
                                        El límite de crédito define el monto máximo de compra
                                    </small>
                                </li>
                                <li class="mb-2">
                                    <small class="text-muted">
                                        <i class="fas fa-percentage me-1 text-warning"></i>
                                        El descuento se aplica automáticamente a las compras
                                    </small>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts específicos para formulario de clientes -->
<th:block layout:fragment="scripts">
    <script th:src="@{/js/clienteFormulario.js}"></script>
</th:block>
</body>
</html>