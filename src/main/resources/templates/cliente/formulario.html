<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}">
<head>
    <title th:text="${cliente.idCliente != null} ? 'Editar Cliente' : 'Nuevo Cliente'">Formulario de Cliente</title>
    <th:block layout:fragment="styles">
        <style>
            .form-section {
                background: #f8f9fa;
                border-radius: 10px;
                padding: 20px;
                margin-bottom: 20px;
                border-left: 4px solid #0d6efd;
            }
            
            .form-title {
                color: #0d6efd;
                font-weight: 600;
                margin-bottom: 15px;
                display: flex;
                align-items: center;
            }
            
            .form-title i {
                margin-right: 10px;
                font-size: 1.2rem;
            }
            
            .required-field::after {
                content: " *";
                color: #dc3545;
            }
        </style>
    </th:block>
</head>
<body>
    <div layout:fragment="content">
        <!-- Encabezado -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center">
                    <h2>
                        <i class="fas fa-user text-primary me-2"></i>
                        <span th:text="${cliente.idCliente != null} ? 'Editar Cliente' : 'Nuevo Cliente'"></span>
                    </h2>
                    <a th:href="@{/clientes}" class="btn btn-secondary">
                        <i class="fas fa-arrow-left me-2"></i>
                        Volver
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Formulario -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">
                            <i class="fas fa-user-edit me-2"></i>
                            Información del Cliente
                        </h5>
                    </div>
                    
                    <div class="card-body">
                        <form th:action="${cliente.idCliente != null} ? @{/clientes/actualizar/{id}(id=${cliente.idCliente})} : @{/clientes/guardar}" 
                              th:object="${cliente}" 
                              method="post">
                            
                            <!-- Información Personal -->
                            <div class="form-section">
                                <h5 class="form-title">
                                    <i class="fas fa-user-circle"></i>
                                    Información Personal
                                </h5>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="nombre" class="form-label required-field">Nombre</label>
                                            <input type="text" 
                                                   class="form-control" 
                                                   id="nombre" 
                                                   th:field="*{nombre}" 
                                                   placeholder="Ingrese el nombre"
                                                   required>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="apellido" class="form-label required-field">Apellido</label>
                                            <input type="text" 
                                                   class="form-control" 
                                                   id="apellido" 
                                                   th:field="*{apellido}" 
                                                   placeholder="Ingrese el apellido"
                                                   required>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label for="tipoDocumento" class="form-label">Tipo de Documento</label>
                                            <select class="form-select" id="tipoDocumento" th:field="*{tipoDocumento}">
                                                <option value="">Seleccione...</option>
                                                <option value="CC">Cédula de Ciudadanía</option>
                                                <option value="NIT">NIT</option>
                                                <option value="CE">Cédula de Extranjería</option>
                                                <option value="PAS">Pasaporte</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-8">
                                        <div class="mb-3">
                                            <label for="numeroDocumento" class="form-label">Número de Documento</label>
                                            <input type="text" 
                                                   class="form-control" 
                                                   id="numeroDocumento" 
                                                   th:field="*{numeroDocumento}" 
                                                   placeholder="Ingrese el número de documento">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Información de Contacto -->
                            <div class="form-section">
                                <h5 class="form-title">
                                    <i class="fas fa-address-book"></i>
                                    Información de Contacto
                                </h5>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="celular" class="form-label">Celular</label>
                                            <input type="tel" 
                                                   class="form-control" 
                                                   id="celular" 
                                                   th:field="*{celular}" 
                                                   placeholder="Ingrese el número de celular">
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="correoElectronico" class="form-label">Correo Electrónico</label>
                                            <input type="email" 
                                                   class="form-control" 
                                                   id="correoElectronico" 
                                                   th:field="*{correoElectronico}" 
                                                   placeholder="Ingrese el correo electrónico">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="direccion" class="form-label">Dirección</label>
                                    <textarea class="form-control" 
                                              id="direccion" 
                                              th:field="*{direccion}" 
                                              rows="3" 
                                              placeholder="Ingrese la dirección completa"></textarea>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="ciudad" class="form-label">Ciudad</label>
                                            <input type="text" 
                                                   class="form-control" 
                                                   id="ciudad" 
                                                   th:field="*{ciudad}" 
                                                   placeholder="Ingrese la ciudad">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Configuración del Cliente -->
                            <div class="form-section">
                                <h5 class="form-title">
                                    <i class="fas fa-cog"></i>
                                    Configuración del Cliente
                                </h5>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="tipoCliente" class="form-label required-field">Tipo de Cliente</label>
                                            <select class="form-select" id="tipoCliente" th:field="*{tipoCliente}" required>
                                                <option value="">Seleccione...</option>
                                                <option value="Regular">Regular</option>
                                                <option value="Premium">Premium</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="fechaRegistro" class="form-label">Fecha de Registro</label>
                                            <input type="date" 
                                                   class="form-control" 
                                                   id="fechaRegistro" 
                                                   th:field="*{fechaRegistro}">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Botones de acción -->
                            <div class="row">
                                <div class="col-12">
                                    <div class="d-flex justify-content-end gap-2">
                                        <a th:href="@{/clientes}" class="btn btn-secondary">
                                            <i class="fas fa-times me-2"></i>
                                            Cancelar
                                        </a>
                                        
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fas fa-save me-2"></i>
                                            <span th:text="${cliente.idCliente != null} ? 'Actualizar' : 'Guardar'"></span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <th:block layout:fragment="scripts">
        <script>
            // Validación del formulario
            document.addEventListener('DOMContentLoaded', function() {
                const form = document.querySelector('form');
                
                form.addEventListener('submit', function(e) {
                    const nombre = document.getElementById('nombre').value.trim();
                    const apellido = document.getElementById('apellido').value.trim();
                    const tipoCliente = document.getElementById('tipoCliente').value;
                    
                    if (!nombre || !apellido || !tipoCliente) {
                        e.preventDefault();
                        alert('Por favor complete todos los campos obligatorios');
                        return;
                    }
                    
                    // Validación de email si está presente
                    const email = document.getElementById('correoElectronico').value.trim();
                    if (email && !isValidEmail(email)) {
                        e.preventDefault();
                        alert('Por favor ingrese un correo electrónico válido');
                        return;
                    }
                });
                
                // Auto-completar fecha de registro si está vacía
                const fechaRegistro = document.getElementById('fechaRegistro');
                if (!fechaRegistro.value) {
                    const today = new Date().toISOString().split('T')[0];
                    fechaRegistro.value = today;
                }
            });
            
            function isValidEmail(email) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(email);
            }
        </script>
    </th:block>
</body>
</html>